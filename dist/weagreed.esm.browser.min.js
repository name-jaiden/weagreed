/**
 * weagreed v0.0.9
 * (c) 2019 Jaiden
 * @license MIT
 */
const e=require("path"),n=require("fs"),r=n=>{const r=e.resolve(__dirname,"./../../../");return e.resolve(r,n)},t=function(e){return n.statSync(e).isFile()},o=function(e){return n.statSync(e).isDirectory()},c=function(e){return n.existsSync(e)};function i(e,n){e.forEach(e=>{const t=r(`${n}/${e}`);if(!c(t))throw console.error(`lack of a necessary folder ${e}`),new Error})}const s=require("path"),u=require("fs");function l(e){const n=function e(n,r=[],c="."){return u.readdirSync(n).forEach(i=>{const u=s.join(n,i);t(u)&&/\.vue$/.test(i)?r.push({[i.split(".vue")[0]]:`${c}/${i}`}):o(u)&&e(u,r,`${c}/${i}`)}),r}(e),r=s.join(e,"index.js"),c=n.map(e=>{const[[n,r]]=Object.entries(e);return`export ${n} from '${r}'`});u.writeFileSync(r,c.join("\n"))}function p(e,n=[],r=".",i){const a=["children","compose"],f=u.readdirSync(e),d=s.join(e,"index.vue"),$=s.join(e,"children"),h=s.join(e,"compose"),g=c(d)&&t(d),j=c($)&&o($),y=c(h)&&o(h);if(g){y&&l(h);const e=function(e,n,r,t){const o={path:n?e.split("/").pop():e.replace(/^./,""),component:`() => import('${e}/index.vue')`};if(r){const n=p(t,[],`${e}/children`,!0);n.length&&(o.children=n)}return o}(r,i,j,$),t=function(e){const n=u.readFileSync(e,"utf8");let r;try{const e=n.split("<script>")[1].split("<\/script>")[0].split("default")[1].split("routerConfig")[1].replace(/(;|\r|\n|\s)/g,"").slice(1,-1);r=new Function(`return ${e}`)()}catch(e){r={}}return r}(d);n.push(Object.assign(e,t))}return f.forEach(t=>{const c=s.join(e,t);o(c)&&!a.includes(t)&&p(c,n,`${r}/${t}`,i)}),n}function a(e){const n=r(e),t=s.join(n,"index.js"),o=p(n),c=(i=(i=o)||{},JSON.stringify(i).replace(/("component":)"(.*?)"/g,(e,n,r)=>`${n}${r}`).replace(/\"/g,"'").replace(/\[\{/g,"[\n{").replace(/}]/g,"}\n]").replace(/,/g,",\n"));var i;u.writeFileSync(t,`export default ${c}`)}i(["Api","Components","controllers","Pages","Servers","Ui"],"src"),a("src/Pages");export default{checkMustFolderList:i,generateRouter:a,version:"0.0.9"};export{i as checkMustFolderList,a as generateRouter};